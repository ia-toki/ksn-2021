<!-- Title: Self Permutation -->

<h3>Description</h3>

<p>
  There exists a sequence $A$ of size $N$ whose each element is an integer from $1$ to $N$.
  There is no integer that appears more than once in the sequence $A$.
</p><p>
  Pak Dengklek wants to play with this sequence.
  He can perform deletion operation by doing the following:
</p>
<ol>
  <li>Choose two adjacent integers in sequence $A$.</li>
  <li>From both of the chosen integers, delete the larger integer.</li>
</ol>
<p>
  For example, if the sequence is $[2, 5, 1, 3, 4]$, and Pak Dengklek chooses $1$ and $3$ which are adjacent in that sequence, then Pak Dengklek can delete $3$ and the sequence turns into $[2, 5, 1, 4]$.
</p><p>
  Pak Dengklek can perform deletion operations any number of times (possibly none) as long as the sequence has at least two integers.
  Pak Dengklek wonders, how many different final sequences that he can obtain after performing the deletion operations.
  Since the number of different final sequences can be very large, calculate the value modulo $1\;000\;000\;007$.
</p>

<h3>Constraints</h3>

<ul>
  <li>$1 \le N \le 300\;000$</li>
  <li>$1 \le A_i \le N$</li>
  <li>There is no integer that appears more than once in $A$.</li>
</ul>

<h3>Subtasks</h3>

<ol>
  <li>&nbsp;&nbsp;(8 points) Contains only the following test case: <br/>
    $N = 6$, $A = [2, 5, 1, 3, 4, 6]$.</li>
  <li>(20 points) $N \le 200$</li>
  <li>(13 points) $N \le 2000$, $A_i = i$</li>
  <li>&nbsp;&nbsp;(9 points) $A_i = i$</li>
  <li>(23 points) $N \le 2000$</li>
  <li>(27 points) No additional constraints.</li>
</ol>

<h3>Input</h3>

<p>
  The input is given with the following format:
</p>

<pre>
N
A<sub>1</sub> A<sub>2</sub> â€¦ A<sub>N</sub>
</pre>

<h3>Output</h3>

<p>
  An integer representing the number of different sequences that can be obtained modulo $1\;000\;000\;007$.
</p>

<h3>Sample Input 1</h3>

<pre>
3
2 3 1
</pre>

<h3>Sample Output 1</h3>

<pre>
3
</pre>

<h3>Explanation of Sample 1</h3>

<p>
  The followings are possible deletion operations that can be performed to the sequence:
</p>

<ul>
  <li>$[2, 3, 1]$ without any deletion.</li>
  <li>$[2, 3, 1] \rightarrow [2, 1]$ by choosing $2$ and $3$. Choosing $3$ and $1$ will also result in the same sequence.</li>
  <li>$[2, 3, 1] \rightarrow [2, 1] \rightarrow [1]$</li>
</ul>

<h3>Sample Input 2</h3>

<pre>
4
2 1 4 3
</pre>

<h3>Sample Output 2</h3>

<pre>
6
</pre>

<h3>Explanation of Sample 2</h3>

<p>
  The followings are possible deletion operations that can be performed to the sequence:
</p>

<ul>
  <li>$[2, 1, 4, 3]$</li>
  <li>$[2, 1, 4, 3] \rightarrow [1, 4, 3]$</li>
  <li>$[2, 1, 4, 3] \rightarrow [1, 4, 3] \rightarrow [1, 3]$</li>
  <li>$[2, 1, 4, 3] \rightarrow [1, 4, 3] \rightarrow [1, 3] \rightarrow [1]$</li>
  <li>$[2, 1, 4, 3] \rightarrow [2, 1, 3]$</li>
  <li>$[2, 1, 4, 3] \rightarrow [2, 1, 3] \rightarrow [2, 1]$</li>
</ul>
